# SPXQuery Version 0.1.x Changelog

This file tracks all changes for the 0.1.x release series.

## Version 0.2.1

**Release Date**: 2025-11-05
**Git Tag**: v0.2.1

### Photometry Background Mask

- **src/spxquery/processing/fits_handler.py**: `create_background_mask` now retains SOURCE-flagged pixels when building the zodiacal-light background mask so local annuli keep nearby source pixels available for brightness scaling, improving robustness around bright targets.

## Version 0.2.0

**Release Date**: 2025-10-27
**Git Tag**: v0.2.0

### New Features

**src/spxquery/core/config.py**

- Added advanced parameter configuration system with three new dataclasses:
  - `PhotometryConfig`: Configurable photometry parameters (aperture, background annulus, sigma clipping, zodiacal scaling)
  - `VisualizationConfig`: Configurable visualization parameters (colormaps, marker sizes, figure settings, DPI)
  - `DownloadConfig`: Configurable download parameters (chunk size, timeouts, retries, user agent)
  - `AdvancedConfig`: Container class holding all three config types
- Reorganized class definition order to place config classes before QueryConfig to fix dependency issues
- Added comprehensive validation in `__post_init__` methods for all config classes
- Added `to_dict()`, `from_dict()`, `to_json_file()`, and `from_json_file()` serialization methods
- Dynamic version in `user_agent`: Changed from hardcoded "SPXQuery/0.1.0" to use package `__version__` automatically

**src/spxquery/utils/params.py**

- New utility module for parameter template management
- `export_default_parameters()`: Export default configuration template to JSON file
- `load_advanced_config()`: Load configuration from JSON file with validation

**src/spxquery/visualization/plots.py**

- Added TYPE_CHECKING import pattern for VisualizationConfig to avoid circular imports
- Updated function signatures to accept VisualizationConfig for customizable plotting

### Priority System

The package now supports a three-tier parameter priority system:

1. Explicit function parameters (highest priority)
2. JSON configuration file parameters
3. Built-in defaults (lowest priority)

Users can export a template with `export_default_parameters()`, customize it, and load it via `QueryConfig(advanced_params_file=...)` or `run_pipeline(advanced_params_file=...)`.

### Technical Improvements

- All configuration classes use dataclasses with field validation
- JSON serialization handles special types (tuples converted to lists for JSON compatibility)
- User agent now dynamically reflects package version for better API tracking
- Comprehensive test coverage added for all configuration functionality
